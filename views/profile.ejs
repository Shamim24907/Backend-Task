<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Profile</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #fdf6fb, #e0f7fa);
      min-height: 100vh;
      padding: 1rem;
      position: relative;
    }

    /* Floating shapes */
    .shape {
      position: absolute;
      border-radius: 50%;
      opacity: 0.12;
      animation: float 25s infinite alternate;
      pointer-events: none;
    }
    .shape-1 { width: 160px; height: 160px; top: 10%; left: 5%; background: #ffd6e0; animation-delay: 0s;}
    .shape-2 { width: 120px; height: 120px; bottom: 15%; right: 10%; background: #a0e9ff; animation-delay: 5s;}
    .shape-3 { width: 200px; height: 200px; top: 50%; left: 50%; background: #d6f6d6; animation-delay: 10s;}
    @keyframes float {
      0% { transform: translateY(0) translateX(0); }
      50% { transform: translateY(-25px) translateX(15px); }
      100% { transform: translateY(0) translateX(0); }
    }

    /* Glass Card */
    .glass-card {
      backdrop-filter: blur(20px);
      background: rgba(255,255,255,0.35);
      border-radius: 2rem;
      border: 1px solid rgba(255,255,255,0.25);
      box-shadow: 0 10px 40px rgba(0,0,0,0.05);
      padding: 2rem;
      margin-bottom: 1.5rem;
      transition: all 0.3s ease;
    }
    .glass-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 50px rgba(0,0,0,0.08);
    }

    /* Textarea */
    .textarea-field {
      background: rgba(255,255,255,0.25);
      border: 1px solid rgba(127,90,240,0.3);
      border-radius: 1rem;
      padding: 0.75rem 1rem;
      resize: vertical;
      min-height: 120px;
      transition: all 0.3s ease;
      color: #333;
    }
    .textarea-field:focus {
      outline: none;
      background: rgba(255,255,255,0.35);
      border-color: #ff85a2;
    }

    /* Buttons */
    .btn-post {
      background: linear-gradient(135deg, #ff85a2 0%, #ffb6b9 100%);
      color: #fff;
      font-weight: 600;
      border-radius: 9999px;
      padding: 0.75rem 1.5rem;
      transition: all 0.3s ease;
    }
    .btn-post:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(255,133,162,0.4);
    }

    .btn-action {
      background: rgba(255,255,255,0.2);
      border: 1px solid rgba(255,255,255,0.3);
      color: #333;
      transition: all 0.3s ease;
      border-radius: 9999px;
      padding: 0.5rem 1rem;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
    }
    .btn-like:hover { background: rgba(160,233,255,0.25); transform: scale(1.05); }
    .btn-edit:hover { background: rgba(127,90,240,0.25); border-color: rgba(127,90,240,0.5); }
    .btn-delete:hover { background: rgba(255,182,193,0.25); border-color: rgba(255,182,193,0.5); }
    .btn-logout:hover { background: rgba(255,182,193,0.25); border-color: rgba(255,182,193,0.5); }
  </style>
</head>
<body>

  <!-- Floating shapes -->
  <div class="shape shape-1"></div>
  <div class="shape shape-2"></div>
  <div class="shape shape-3"></div>

  <div class="max-w-4xl mx-auto">

    <!-- Profile Header -->
    <div class="glass-card flex items-center justify-between">
      <div class="flex items-center gap-4">
        <div class="w-16 h-16 rounded-full bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center text-white text-2xl font-bold">
          <%= user.email.charAt(0).toUpperCase() %>
        </div>
        <div>
          <h1 class="text-2xl font-bold"><%= user.email %></h1>
          <p class="text-purple-500 text-sm">Your Profile</p>
        </div>
      </div>
      <a href="/logout" class="btn-logout">Logout</a>
    </div>

    <!-- Create Post -->
    <div class="glass-card">
      <h2 class="text-xl font-bold mb-4">Create New Post</h2>
      <form method="POST" action="/posts/create-post" enctype="multipart/form-data" class="space-y-4">
        <textarea name="content" maxlength="2000" required class="textarea-field w-full" placeholder="What's on your mind?"></textarea>

        <div class="file-input-wrapper relative overflow-hidden border-2 border-dashed border-gray-300 rounded-xl p-4 cursor-pointer">
          <span class="text-purple-500 font-medium">Choose an image (Optional)</span>
          <input type="file" name="image" class="file-input absolute w-full h-full top-0 left-0 opacity-0 cursor-pointer" accept="image/*">
        </div>

        <div class="flex justify-end">
          <button type="submit" class="btn-post">Post</button>
        </div>
      </form>
    </div>

    <!-- Posts List -->
    <div class="space-y-4">
      <% if (posts.length===0) { %>
      <div class="glass-card text-center p-12">
        <p class="font-semibold text-purple-500 mb-2">No posts yet</p>
        <p class="text-purple-300">Create your first post to get started!</p>
      </div>
      <% } else { %>
        <% posts.forEach(post => { %>
        <div class="glass-card">
          <div class="flex items-start gap-4">
            <div class="w-12 h-12 rounded-full bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center text-white font-bold">
              <%= user.email.charAt(0).toUpperCase() %>
            </div>
            <div class="flex-1">
              <div class="flex items-center justify-between mb-3">
                <h3 class="font-semibold"><%= user.email %></h3>
              </div>
              <p class="text-purple-700 mb-4"><%= post.content %></p>

              <% if (post.imagePath) { %>
              <div class="mb-4 rounded-xl overflow-hidden border border-purple-300">
                <img src="<%= post.imagePath %>" alt="Post Image" class="w-full object-cover max-h-96">
              </div>
              <% } %>

              <div class="flex items-center gap-3 flex-wrap">
                <form method="POST" action="/posts/like/<%= post.id %>">
                  <button type="submit" class="btn-action btn-like">
                    Like <%= post.likes?.length || 0 %>
                  </button>
                </form>

                <% if (post.userId === user.id) { %>
                <a href="/posts/edit/<%= post.id %>" class="btn-action btn-edit">Edit</a>
                <a href="/posts/delete/<%= post.id %>" class="btn-action btn-delete">Delete</a>
                <% } %>
              </div>
            </div>
          </div>
        </div>
        <% }) %>
      <% } %>
    </div>

  </div>

</body>
</html>
